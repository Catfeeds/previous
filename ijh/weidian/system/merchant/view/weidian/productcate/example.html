<{include file="merchant:block/header.html"}>

<div class="row">
    <div class="col-lg-12">
        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>添加分类</h5>
            </div>
            <div class="ibox-content">

                <form action="<{link ctl='merchant/weidian/productcate:create'}>" mini-form="merchant" method="post"
                      ENCTYPE="multipart/form-data" role="form" class="form-horizontal m-t">


                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">父级分类：</label>
                        <div class="col-sm-4">
                            <select class="form-control" name="data[parent_id]">
                                <option value="0">顶级分类</option>
                                <{foreach $cate_list as $k=>$v}>

                                <{if $v.cate_id != $detail.cate_id}>
                                <option value="<{$v.cate_id}>"
                                <{if $v.cate_id==$detail.parent_id}> selected <{/if}> ><{$v.title}></option>
                                <{/if}>

                                <{/foreach}>
                            </select>
                        </div>
                    </div>
                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">标题：</label>
                        <div class="col-sm-4">
                            <input type="text" name="data[title]" value="<{$detail.title}>" class="form-control"
                                   placeholder="请输入标题">
                        </div>
                    </div>

                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">图片：</label>
                        <div class="col-sm-10" >
                            <div class="col-sm-4"><input type="text" name="data[xxxpic]" class="form-control"
                                                         id="file_photo" value=""/></div>
                            <div class="col-sm-8"><input type="button" uploadbtn="#file_photo"
                                                         class="ke-upload_lay pull-left" value=" 选择文件 "/>
                                <a preview="#file_photo" class="btn btn-success btn-outline">
                                    <i class="fa fa-th"></i> 预览</a>

                            </div>
                        </div>
                    </div>

                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">图片：</label>
                        <div class="col-sm-10" >
                            <div class="col-sm-4"><input type="text" name="data[photo_other]" class="form-control"
                                                         id="file_photo" value=""/></div>
                            <div class="col-sm-8"><input type="button" uploadbtn1="#file_photo"
                                                         class="ke-upload_lay pull-left" value=" 选择文件 "/>
                                <a preview_other="#file_photo" class="btn btn-success btn-outline">
                                    <i class="fa fa-th"></i> 预览</a>

                            </div>
                        </div>
                    </div>

                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">时间：</label>
                        <div class="col-sm-4">
                            <div class="input-group date">
                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                <input type="text" name="data[stime]" id="stime" value="<{$detail.stime}>"
                                       class="form-control"
                                       onFocus="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',maxDate:'#F{$dp.$D(\'stime\',{d:-1})}'})"/>
                            </div>
                        </div>

                    </div>


                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">金额(整数)：</label>
                        <div class="col-sm-4">
                            <div class="input-group m-b"><span class="input-group-addon">¥</span>
                                <input type="text" class="form-control">
                                <span class="input-group-addon">.00</span>
                            </div>
                        </div>

                    </div>

                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">金额(小数)：</label>
                        <div class="col-sm-4">
                            <div class="input-group m-b"><span class="input-group-addon">¥</span>
                                <input type="text" class="form-control">
                            </div>
                        </div>

                    </div>


                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">选择按钮：</label>
                        <div class="col-sm-4">

                            <strong>class内 checkbox-inline 是保持在一行的样式</strong>
                            <div class="checkbox checkbox-success">
                                <input id="checkbox3" type="checkbox" checked>
                                <label for="checkbox3">
                                    info 绿色 <strong>一般全选什么的,用浅蓝色</strong>
                                </label>
                            </div>

                            <div class="checkbox ">
                                <input id="checkboxs2" type="checkbox" checked>
                                <label for="checkboxs2">
                                    Primary 蓝色
                                </label>
                            </div>

                        </div>

                    </div>

                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">单选按钮：</label>
                        <div class="col-sm-4">

                            <strong>class内 radio-inline 是保持在一行的样式</strong>
                            <div class="radio radio-success radio-inline">
                                <input type="radio" id="inlineRadio1" value="option1" name="radioInline" checked="">
                                <label for="inlineRadio1"> Inline One 开启 </label>
                            </div>

                            <div class="radio radio-inline">
                                <input type="radio" id="inlineRadio2" value="option2" name="radioInline">
                                <label for="inlineRadio2"> Inline Two 关闭 </label>
                            </div>

                        </div>

                    </div>


                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">开关插件Switcher：</label>

                        <div class="col-sm-10">

                            <div class="alert alert-info">
                                每一个按钮,都要写单独js, js代码和 class 关联,
                                <br />
                                var elem = document.querySelector('.js-switch');
                                <br />
                                var switchery = new Switchery(elem, {color: '#1AB394'});
                                <br />
                                //第二个按钮js
                                <br />
                                var elem_2 = document.querySelector('.js-switch_2');
                                <br />
                                var switchery_2 = new Switchery(elem_2, {color: '#1AB394'});
                            </div>
                            <div class="col-sm-12">
                                <input type="checkbox" class="js-switch" name="is_daofu" checked/>
                                <strong>checked 选中状态, 引入js</strong>
                            </div>
                            <div class="col-sm-12">
                                <input type="checkbox" class="js-switch_2" name="is_daofu"/>
                                <strong>checked 未选中状态, </strong>
                            </div>
                        </div>
                    </div>

                    <script>
                        var elem = document.querySelector('.js-switch');
                        var switchery = new Switchery(elem, {color: '#1AB394'});
                        //第二个按钮js
                        var elem_2 = document.querySelector('.js-switch_2');
                        var switchery_2 = new Switchery(elem_2, {color: '#1AB394'});
                    </script>

                    <div class="form-group draggable">
                        <label class="col-sm-2 control-label">排序：</label>

                        <div class="col-sm-4">
                            <input type="text" name="data[orderby]" value="<{$detail.orderby}>" class="form-control"/>
                        </div>
                    </div>


                    <div class="hr-line-dashed"></div>
                    <div class="form-group draggable">
                        <div class="col-sm-4 col-sm-offset-2">
                            <button class="btn btn-primary" type="submit">保存修改</button>
                            <!-- <button class="btn btn-white" type="submit">取消</button> -->
                        </div>
                    </div>


                </form>
            </div>
        </div>

    </div>
</div>

<{include file="merchant:block/footer.html"}>

<script type="text/javascript">

    //第二个图片专用,第一个用公用默认的
    (function (K, $) {
        KindEditor.ready(function (KE) {
            $("[uploadbtn1]").each(function () {
                var upload_url = $(this).attr("uploadbtn1")
                var uploadbutton = KE.uploadbutton({
                    button: $(this)[0],
                    fieldName: 'imgFile',
                    url: '/merchant/?upload/photo.html',
                    afterUpload: function (data) {
                        if (data.error === 0) {
                            var photo = data.photo;
//                            KE(upload_url).val(photo);
                            $("input[name^='data[photo_other]']").val(photo);
                            $("input[name^='data[photo_other]']").attr("photo", "<{$pager.img}>/" + photo);
//                            KE(upload_url).attr("photo", "http://shequ.jhcms.cn/./attachs/" + photo);
//                            Widget.MsgBox.info('上传图片成功');
                            layer.msg('上传图片成功');
                        } else {
                            alert(data.message);
                        }
                    },
                    afterError: function (str) {
                        alert(str);
                    }
                });
                uploadbutton.fileBox.change(function (e) {
                    uploadbutton.submit();
                });
            });
            $(".ke-upload_lay .ke-button").removeClass().addClass("btn btn-success ");
            $(".ke-upload_lay .ke-button-common").removeClass("ke-button-common");
            $(document).on("click", "[preview_other]", function () {
                var el = $("input[name^='data[photo_other]']");
                if ($(el).attr('photo')) {
                    layer.open({
                        type: 1,
                        shade: false,
                        title: false,
                        area: [400, 400],
                        cancel: function (index) {
                            layer.close(index);
                        },
                        content: '<img src="' + $(el).attr('photo') + '" width="400" height="400"/>'
                    });
                } else {
                    alert("还没有添加图片");
                }
            });
        });
    })(window.KT, window.jQuery);
</script>

<style>
    .ke-upload-area .ke-upload-file {
        position: absolute;
        font-size: 30px;
        top: 0;
        right: 0;
        padding: 0;
        margin: 0;
        z-index: 811212;
        border: 0 none;
        opacity: 0;
        filter: alpha(opacity=0);
    }

    .ke-upload_lay {
        position: relative;
    }
</style>
